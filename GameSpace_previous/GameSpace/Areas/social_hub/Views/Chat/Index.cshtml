@{
    ViewData["Title"] = "Chat Test (1 to 1)";
    var meIdStr = Context.Request.Cookies["sh_uid"] ?? "0";
    var meName = Context.Request.Cookies["sh_uname"] ?? "Guest";
}

<link href="~/lib/social_hub/css/chat.css" rel="stylesheet" />
<link href="~/lib/social_hub/css/chat-1to1.css" rel="stylesheet" />

<meta name="me-id" content="@meIdStr" />
<meta name="me-name" content="@meName" />



<div class="chat-layout" style="display:flex; gap:12px; height:70vh;">
    <!-- 聯絡人 -->
    <aside class="contacts" style="width:260px; border:1px solid #ddd; border-radius:8px; overflow:auto;">
        <div class="p-2"><strong>Contacts</strong></div>
        <ul id="contactList" class="list-unstyled m-0"></ul>
    </aside>

    <!-- 對話 -->
    <section class="dialog" style="flex:1; border:1px solid #ddd; border-radius:8px; display:flex; flex-direction:column;">
        <div id="peerTitle" class="p-2 border-bottom">No contact selected</div>
        <div id="messages" class="flex-grow-1" style="overflow:auto; padding:8px;"></div>
        <form id="chatForm" class="p-2 border-top" style="display:flex; gap:8px;">
            <input id="messageInput" class="form-control" placeholder="Enter message..." autocomplete="off" />
            <button class="btn btn-primary" type="submit" disabled id="sendBtn">Send</button>
        </form>
    </section>
</div>

<!-- Security: Stable AntiForgery Token -->
<form id="__af" method="post" style="display:none;">
    @Html.AntiForgeryToken()
</form>

@section Scripts {
    <script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
    <script src="~/lib/social_hub/js/chat-1to1.js"></script>
}
