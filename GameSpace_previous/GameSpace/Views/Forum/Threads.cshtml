@model List<Thread>
@{
    ViewData["Title"] = ViewBag.Forum.ForumName + " - 論壇";
    Layout = "_Layout";
    var forum = ViewBag.Forum as Forum;
}

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>@forum.ForumName - 論壇</title>
    <style>
        :root{
            --bg:#eef3f8; --bg2:#ffffff; --ink:#1f2937; --muted:#64748b; --line:#e5e7eb;
            --surface:rgba(255,255,255,.75); --glass:rgba(255,255,255,.45);
            --accent:#7557ff; --accent-2:#34d2ff; --accent-3:#22c55e;
            --radius:18px; --radius-sm:12px; --shadow:0 18px 40px rgba(17,24,39,.12);
            --blur:14px;
        }
        body.dark{
            --bg:#0c111b; --bg2:#0a0f18; --ink:#e5edff; --muted:#9fb1c9; --line:#1e2b43;
            --surface:rgba(22,30,48,.65); --glass:rgba(18,24,39,.50);
            --shadow:0 18px 42px rgba(0,0,0,.35);
        }
        *{box-sizing:border-box} html,body{height:100%}
        body{
            margin:0; color:var(--ink); font:16px/1.65 system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
            background:
                radial-gradient(900px 500px at -10% -10%, rgba(117,87,255,.10), transparent 60%),
                radial-gradient(800px 460px at 110% 10%, rgba(52,210,255,.10), transparent 50%),
                linear-gradient(180deg, var(--bg), var(--bg2));
        }
        .wrap{max-width:1200px; margin:0 auto; padding:0 16px}
        
        /* 討論串項目 */
        .thread-item{
            background:var(--glass); border:1px solid var(--line); border-radius:15px; 
            padding:20px; backdrop-filter:blur(var(--blur)); box-shadow:var(--shadow);
            margin:10px 0; transition:all 0.3s ease; cursor:pointer;
        }
        .thread-item:hover{transform:translateY(-2px); box-shadow:0 20px 40px rgba(0,0,0,0.1)}
        .thread-item.pinned{border-left:4px solid var(--accent); background:linear-gradient(90deg, rgba(117,87,255,0.1), var(--glass))}
        
        .thread-header{display:flex; align-items:center; gap:15px; margin-bottom:10px}
        .thread-icon{width:40px; height:40px; border-radius:50%; background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:flex; align-items:center; justify-content:center; font-size:18px; color:#fff}
        .thread-info{flex:1}
        .thread-title{font-size:18px; font-weight:900; color:var(--ink); margin-bottom:5px; display:flex; align-items:center; gap:10px}
        .thread-author{color:var(--muted); font-size:14px}
        .thread-content{color:var(--muted); font-size:14px; margin:10px 0; line-height:1.5}
        
        .thread-meta{display:flex; align-items:center; gap:20px; margin-top:15px; padding-top:15px; border-top:1px solid var(--line); font-size:13px; color:var(--muted)}
        .meta-item{display:flex; align-items:center; gap:5px}
        .meta-value{font-weight:700; color:var(--ink)}
        
        .pinned-badge{background:var(--accent); color:#fff; padding:2px 8px; border-radius:12px; font-size:12px; font-weight:700}
        
        /* 按鈕 */
        .btn-create{background:linear-gradient(135deg,var(--accent),#3b82f6); color:#fff; border:none; padding:12px 24px; border-radius:12px; font-weight:700; cursor:pointer; transition:all 0.3s ease; box-shadow:var(--shadow)}
        .btn-create:hover{transform:translateY(-2px); box-shadow:0 8px 25px rgba(117,87,255,0.4)}
        
        /* 空狀態 */
        .empty-state{text-align:center; padding:60px 20px; color:var(--muted)}
        .empty-icon{font-size:48px; margin-bottom:20px}
        .empty-title{font-size:20px; font-weight:700; margin-bottom:10px; color:var(--ink)}
        .empty-desc{font-size:14px}
    </style>
</head>
<body>
    <div class="wrap">
        <div style="display:flex; justify-content:space-between; align-items:center; margin:30px 0">
            <div>
                <h1 style="font-size:28px; font-weight:900; color:var(--ink); margin:0">@forum.ForumName</h1>
                <p style="color:var(--muted); margin:5px 0 0 0">@forum.Description</p>
            </div>
            <a href="/Forum/CreateThread/@forum.ForumId" class="btn-create">+ 發起討論</a>
        </div>
        
        @if (Model.Any())
        {
            @foreach (var thread in Model)
            {
                <div class="thread-item @(thread.IsPinned ? "pinned" : "")" onclick="goToThread(@thread.ThreadId)">
                    <div class="thread-header">
                        <div class="thread-icon">@(thread.AuthorUser?.UserName?.Substring(0, 1).ToUpper() ?? "?")</div>
                        <div class="thread-info">
                            <div class="thread-title">
                                @if (thread.IsPinned)
                                {
                                    <span class="pinned-badge">📌 置頂</span>
                                }
                                @thread.Title
                            </div>
                            <div class="thread-author">by @(thread.AuthorUser?.UserName ?? "匿名用戶")</div>
                        </div>
                    </div>
                    
                    <div class="thread-content">@(thread.Content.Length > 100 ? thread.Content.Substring(0, 100) + "..." : thread.Content)</div>
                    
                    <div class="thread-meta">
                        <div class="meta-item">
                            <span>💬</span>
                            <span class="meta-value">@thread.ReplyCount 回覆</span>
                        </div>
                        <div class="meta-item">
                            <span>👀</span>
                            <span class="meta-value">@thread.ViewCount 瀏覽</span>
                        </div>
                        <div class="meta-item">
                            <span>⏰</span>
                            <span class="meta-value">@thread.LastActivity?.ToString("MM/dd HH:mm")</span>
                        </div>
                        <div class="meta-item">
                            <span>📅</span>
                            <span class="meta-value">@thread.CreatedAt.ToString("yyyy/MM/dd")</span>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="empty-state">
                <div class="empty-icon">📭</div>
                <div class="empty-title">暫無討論串</div>
                <div class="empty-desc">還沒有任何討論，快來發起第一個吧！</div>
            </div>
        }
    </div>

    <script>
        function goToThread(threadId) {
            window.location.href = '/Forum/Thread/' + threadId;
        }
    </script>
</body>
</html>