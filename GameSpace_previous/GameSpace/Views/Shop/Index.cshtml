@model List<ProductInfo>
@{
    ViewData["Title"] = "å•†åŸ - GameSpace";
    Layout = "_Layout";
}

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>å•†åŸ - GameSpace</title>
    <style>
        :root{
            --bg:#eef3f8; --bg2:#ffffff; --ink:#1f2937; --muted:#64748b; --line:#e5e7eb;
            --surface:rgba(255,255,255,.75); --glass:rgba(255,255,255,.45);
            --accent:#7557ff; --accent-2:#34d2ff; --accent-3:#22c55e;
            --radius:18px; --radius-sm:12px; --shadow:0 18px 40px rgba(17,24,39,.12);
            --blur:14px;
        }
        body.dark{
            --bg:#0c111b; --bg2:#0a0f18; --ink:#e5edff; --muted:#9fb1c9; --line:#1e2b43;
            --surface:rgba(22,30,48,.65); --glass:rgba(18,24,39,.50);
            --shadow:0 18px 42px rgba(0,0,0,.35);
        }
        *{box-sizing:border-box} html,body{height:100%}
        body{
            margin:0; color:var(--ink); font:16px/1.65 system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
            background:
                radial-gradient(900px 500px at -10% -10%, rgba(117,87,255,.10), transparent 60%),
                radial-gradient(800px 460px at 110% 10%, rgba(52,210,255,.10), transparent 50%),
                linear-gradient(180deg, var(--bg), var(--bg2));
        }
        .wrap{max-width:1200px; margin:0 auto; padding:0 16px}
        
        /* å•†å“ç¶²æ ¼ */
        .products-grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:20px; margin:30px 0}
        
        .product-card{
            background:var(--glass); border:1px solid var(--line); border-radius:20px; 
            padding:20px; backdrop-filter:blur(var(--blur)); box-shadow:var(--shadow);
            transition:all 0.3s ease; cursor:pointer; overflow:hidden;
        }
        .product-card:hover{transform:translateY(-5px); box-shadow:0 25px 50px rgba(0,0,0,0.15)}
        
        .product-image{
            width:100%; height:200px; border-radius:15px; background:linear-gradient(135deg,var(--accent),var(--accent-2));
            margin-bottom:15px; display:flex; align-items:center; justify-content:center;
            font-size:48px; color:#fff; position:relative; overflow:hidden;
        }
        .product-image::before{
            content:''; position:absolute; top:0; left:0; right:0; bottom:0;
            background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="2"/></svg>');
            background-size:60px 60px; animation:float 3s ease-in-out infinite;
        }
        @keyframes float{0%,100%{transform:translateY(0px)}50%{transform:translateY(-10px)}}
        
        .product-title{font-size:18px; font-weight:900; color:var(--ink); margin-bottom:8px; line-height:1.3}
        .product-desc{color:var(--muted); font-size:14px; margin-bottom:15px; line-height:1.5; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden}
        .product-price{font-size:24px; font-weight:900; color:var(--accent); margin-bottom:15px}
        .product-stock{font-size:12px; color:var(--muted); margin-bottom:15px}
        
        .product-actions{display:flex; gap:10px}
        .btn-add-cart{
            flex:1; background:linear-gradient(135deg,var(--accent),#3b82f6); color:#fff;
            border:none; padding:12px; border-radius:12px; font-weight:700; cursor:pointer;
            transition:all 0.3s ease; box-shadow:var(--shadow);
        }
        .btn-add-cart:hover{transform:translateY(-2px); box-shadow:0 8px 25px rgba(117,87,255,0.4)}
        .btn-view{
            background:var(--surface); color:var(--ink); border:2px solid var(--line);
            padding:12px 16px; border-radius:12px; font-weight:700; cursor:pointer;
            transition:all 0.3s ease;
        }
        .btn-view:hover{background:var(--line)}
        
        /* ç¯©é¸å™¨ */
        .filters{
            background:var(--glass); border:1px solid var(--line); border-radius:15px; 
            padding:20px; backdrop-filter:blur(var(--blur)); box-shadow:var(--shadow);
            margin:20px 0; display:flex; gap:20px; align-items:center; flex-wrap:wrap;
        }
        .filter-group{display:flex; align-items:center; gap:10px}
        .filter-label{font-weight:700; color:var(--ink)}
        .filter-select{
            padding:8px 12px; border:2px solid var(--line); border-radius:8px;
            background:var(--surface); color:var(--ink); font-size:14px;
        }
        
        /* ç©ºç‹€æ…‹ */
        .empty-state{text-align:center; padding:60px 20px; color:var(--muted)}
        .empty-icon{font-size:48px; margin-bottom:20px}
        .empty-title{font-size:20px; font-weight:700; margin-bottom:10px; color:var(--ink)}
        .empty-desc{font-size:14px}
    </style>
</head>
<body>
    <div class="wrap">
        <div style="display:flex; justify-content:space-between; align-items:center; margin:30px 0">
            <h1 style="font-size:32px; font-weight:900; color:var(--ink); margin:0">ğŸ›’ éŠæˆ²å•†åŸ</h1>
            <div style="display:flex; gap:15px; align-items:center">
                <a href="/Shop/Cart" style="background:var(--surface); color:var(--ink); padding:12px 20px; border-radius:12px; text-decoration:none; font-weight:700; border:2px solid var(--line)">ğŸ›ï¸ è³¼ç‰©è»Š</a>
                <a href="/Shop/MyOrders" style="background:linear-gradient(135deg,var(--accent),#3b82f6); color:#fff; padding:12px 20px; border-radius:12px; text-decoration:none; font-weight:700; box-shadow:var(--shadow)">ğŸ“¦ æˆ‘çš„è¨‚å–®</a>
            </div>
        </div>
        
        <!-- ç¯©é¸å™¨ -->
        <div class="filters">
            <div class="filter-group">
                <span class="filter-label">åˆ†é¡</span>
                <select class="filter-select">
                    <option>å…¨éƒ¨</option>
                    <option>éŠæˆ²é“å…·</option>
                    <option>è™›æ“¬å•†å“</option>
                    <option>å¯¦é«”å•†å“</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">åƒ¹æ ¼</span>
                <select class="filter-select">
                    <option>å…¨éƒ¨</option>
                    <option>0-100</option>
                    <option>100-500</option>
                    <option>500+</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">æ’åº</span>
                <select class="filter-select">
                    <option>æœ€æ–°</option>
                    <option>åƒ¹æ ¼ä½åˆ°é«˜</option>
                    <option>åƒ¹æ ¼é«˜åˆ°ä½</option>
                    <option>æœ€ç†±é–€</option>
                </select>
            </div>
        </div>
        
        @if (Model.Any())
        {
            <div class="products-grid">
                @foreach (var product in Model)
                {
                    <div class="product-card" onclick="viewProduct(@product.ProductId)">
                        <div class="product-image">ğŸ®</div>
                        <h3 class="product-title">@product.ProductName</h3>
                        <p class="product-desc">@product.Description</p>
                        <div class="product-price">NT$ @product.Price.ToString("N0")</div>
                        <div class="product-stock">åº«å­˜: @product.Stock ä»¶</div>
                        <div class="product-actions">
                            <button class="btn-add-cart" onclick="event.stopPropagation(); addToCart(@product.ProductId)">åŠ å…¥è³¼ç‰©è»Š</button>
                            <button class="btn-view" onclick="event.stopPropagation(); viewProduct(@product.ProductId)">æŸ¥çœ‹è©³æƒ…</button>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="empty-state">
                <div class="empty-icon">ğŸ“¦</div>
                <div class="empty-title">æš«ç„¡å•†å“</div>
                <div class="empty-desc">å•†åŸæ­£åœ¨æº–å‚™ä¸­ï¼Œæ•¬è«‹æœŸå¾…ï¼</div>
            </div>
        }
    </div>

    <script>
        function viewProduct(productId) {
            window.location.href = '/Shop/Product/' + productId;
        }
        
        function addToCart(productId) {
            fetch('/Shop/AddToCart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value
                },
                body: JSON.stringify({
                    productId: productId,
                    quantity: 1
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.message);
                } else {
                    alert(data.message);
                }
            })
            .catch(error => {
                alert('æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
            });
        }
        
        // æ·»åŠ è«‹æ±‚é©—è­‰ä»¤ç‰Œ
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.createElement('form');
            form.style.display = 'none';
            form.innerHTML = '@Html.AntiForgeryToken()';
            document.body.appendChild(form);
        });
    </script>
</body>
</html>